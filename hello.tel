-- Simple example of ad-hoc user defined types

-- main = \i -> ("Hello, World!", 0)
-- main = if 0 then succ "hi" else 0

MyInt = let intTag = unique
        in ( \i -> if not i
                   then "MyInt must not be 0"
                   else (intTag, i)
           , \i -> if dEqual (left i) intTag
                   then 0
                   else "expecting MyInt"
           )
main = \i -> ((left MyInt) 1, 0)
